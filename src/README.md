# Code Summary

The following React components are used to build this application:

## App.js
This component contains basically the entire page, including the `Navbar` which is the title and all the buttons at the top, as well as the three `InputSelection`s, which are shown only if they are the active view. For consistency, we construct our Viz instance here, and then will pass it along to other components so that we have the same one.

This component is not used by any other components, as it is the base.

## InputSelection.js
This component is the content that will be placed inside each of the data views before the user has input any information. It consists of a brief description and two buttons that either allow the user to load in a new dataset after selecting "First Time", requiring the user to put in some information about the process involved with the data, or allow the user to add to a previously saved dataset using "Returning User". Based on the option the user chooses, this will either create the `EnhancedDataInput` component for first-time loading or the `DatasetLoader` component for reloading.

This component is used by the following components:
- `App.js`

## Navbar.js
This component contains the various controls that appear at the top of the page, as well as the title that shows which data view is currently active. Starting from the left, we have the following:
- the title, which shows which data view is active
- the button that allows the user to cycle between the Patient view, Staff view, and Staff Compare view
- the input form for inputting a text file containing expert recommendations that the user wants to load onto the charts
- the button for activating the expert recommendation textboxes below each chart
- the button for saving the contents of all the expert recommendation textboxes to a file that can be loaded into the app

This component is used by the following components:
- `App.js`

## DatasetLoader.js
This component is used if the user specifies that they are a returning user on a view. When the user specifies that they are a returning user, the `DatasetLoader` displays two input forms: one for the formatting of the previous dataset which calls the `LoadOldDataset()` function to reload the formatting when a `.txt` file is uploaded, and one for the new data to load that calls the `LoadNewDataset()` function to parse the new data when a `.xlsx` file is uploaded. Once both files are uploaded, the `ShowCharts()` function displays the visualizations in a `ChartContainer`.

This component is used by the following components:
- `InputSelection.js`

## EnhancedDataInput.js
This component handles the process of loading in the data from the spreadsheet that the user provides, and it does so in a series of different stages, with an exception for the Staff Compare view. First, this component has an input form that ask the user to select the `.xlsx` file that contains their data. Once they select a file, this file is sent to the `ProcessData` function (or the `ProcessComparisonData` function). This function will first generate a workbook using the `LoadFile` function, and then pass that workbook to the `ExtractData` function which generates our initial dataset array, which contains all the columns. 

For the patient and staff views, a dataset is an array which contains each column of spreadsheet in an object with the following properties:
- `name`: The name associated with column of data, typically the name of the step in the process
- `data`: The array of data points for how long it took to complete this step for each time
- `type`: A category selected by the user for grouping steps together, must be either care, wait, travel, or other
- `nextSteps`: An array of steps that this step leads into, as indicated by the user

Once we have an initial dataset, the user needs to give some additional information so that the application can remove unnecessary data, add the categories to each step, and associate the steps with the ones that follow. To do this, the `ProcessData` function has an array of functions that it stores in the component's state (can be accessed with `this.state.steps`) that it will iterate through for each part of this process. There is a next button to move from one function to the next function in the data loading process, and every function takes in a dataset, modifies it, and then gives a processed dataset.

After the data processing steps are all completed, the component saves the dataset to `sessionStorage` for later and calls the `PopulateCharts` function, which renders out the visualizations using a `ChartContainer`.

As mentioned earlier, the data processing for the Staff Compare view is different, and uses the `ProcessComparisonData` function instead of `ProcessData` after a file has been selected. This function will still generate a workbook with `LoadFile`, but it has its own dataset format that is generated by `ExtractComparisonData`. 

For the staff compare view, a dataset is an array of objects, where each object contains the following properties:
- `staff member`: The name of the staff member performing the task
- `task`: The id for the task that was completed
- `day`: The day of the week that the task was completed on
- `duration`: The amount of time it took to complete the task

Unlike the other two views, the only additional data processing that occurs with the staff compare dataset is creating a list of all the staff members, tasks, and days for the charts later, which is handled without user input by the `FindUniqueFields` function. This returns an object with list for each field containing all the unique values found.  

After the fields are collected, the component saves the dataset and fields object to `sessionStorage` for later and calls the `PopulateCharts` function, which renders out the visualizations using a `ChartContainer`.

This component is used by the following components:
- `InputSelection.js`

## ChartContainer.js
This component refers to the holder for all of the visualizations and recommendations on a view. Once a view is given a configured dataset, a new `ChartContainer` is generated using the `GenerateCharts()` function to create the new visualizations and the `GenerateVisualizations()` function to add the recommendations to the charts generated. In the process of generating charts, the function `CreateProcessFlow()` is called to set up the `GraphvizChart`.

This component is used by the following components:
- `DatasetLoader.js`
- `EnhancedDataInput.js`

## Chart.js
This component refers to the visualizations used in all of the dashboards that are generated using Plotly (in simple terms, all the visualizations that are not the process flow). `Chart`s must be given a `chartType` to choose pie or pillar charts, a `fields` to determine what data is being visualized, an `id` to use for recommendations, and a `source` telling it what view this chart is in. Optional values include `datasetIndex`, which gives the index of which uploaded dataset to use for the visualization (use -3 for a cumulative dataset, -2 for a cumulative visualization without the most recent dataset, and -1 for the most recent dataset), and `noButtons` to set if the chart should not generate recommendation and comparison buttons.

This component is used by the following components:
- `ChartContainer.js`

## GraphvizChart.js
This component takes a dot (which is the raw instructions that Graphviz uses to set up the visualization) and generates a Graphviz chart for the process flow.

This component is used by the following components:
- `ChartContainer.js`

## ExportData.js
This component is the button that is displayed in the patient and staff data views that allows the user to save their currently loaded datasets to a `.txt` file. Upon pressing the button, the `exportData()` function will be used to generate the text file, create a download link, and use the link to bring up the saving prompt.

This component is used by the following components:
- `ChartContainer.js`

## AdditionalDataInput.js
This component is the button to add another dataset on a view if a dataset has already been successfully added. This hides the current visualizations and creates a `DatasetAdder` with the `addDataInput()` function.

This component is used by the following components:
- `ChartContainer.js`

## ComparisonChart.js
This component refers to the visualizations used in the Staff Comparison view. There are three different types of `ComparisonChart`s, which can be chosen by the `fields` value. `ComparisonChart`s with a `fields` value of "taskfocus" require a `focus` value of the task to focus on. `ComparisonChart`s with a `fields` value of "dayfocus" require a `focus` value of the day. `ComparisonChart`s with a `fields` value of "persontask" require a `focus` value of the staff member to focus on and a `subfocus` value of the task to focus on.

This component is used by the following components:
- `ChartContainer.js`

## DatasetAdder.js
This component is created when the user specifies that they have another dataset to load on a view. The `DatasetAdder` displays an input form which calls the `LoadNewDataset()` function to parse the new data when a `.xlsx` file is uploaded and add that to the existing dataset. Once the new data is added, it then calls `ShowCharts()` to create a new `ChartContainer` with updated visualizations.

This component is used by the following components:
- `AdditionalDataInput.js`